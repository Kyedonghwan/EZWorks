<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.it.ez.addrbook.model.AddrBookDAO">
	<insert id="insertBook" parameterType="AddrBookVO">
		<selectKey resultType="int" keyProperty="bookNo" order="BEFORE">
			select addr_seq.nextval from dual
		</selectKey>
		insert into addrbook(bookNo, deptName, posName, name, companyName,
						corpPhone, zipcode,  address, addressDetail, hp, email, memo )
		values(#{bookNo},  #{deptName, jdbcType=VARCHAR}, #{posName, jdbcType=VARCHAR}, #{name}, #{companyName, jdbcType=VARCHAR},
			#{corpPhone, jdbcType=VARCHAR},#{zipcode, jdbcType=VARCHAR},#{address, jdbcType=VARCHAR},#{addressDetail, jdbcType=VARCHAR}, #{hp, jdbcType=VARCHAR}, #{email, jdbcType=VARCHAR},#{memo, jdbcType=VARCHAR})
	</insert>
	
	<select id="selectAll" parameterType="addrBookVo" resultType="addrBookVO">
		select *
		from
		(
			select rownum as RNUM,A.*
			from 
			(
				select * from addrbook
				order by bookNo desc
			)A
		)
		<![CDATA[
		where RNUM > #{firstRecordIndex}
		and RNUM <= #{firstRecordIndex} + #{recordCountPerPage}
		]]>
	</select>
	
	<select id ="selectTotalRecord" parameterType="addrBookVo"
		resultType="int">
		select count(*) from addrbook
	</select>
	
	<update id="updateBook" parameterType="addrBookVo">
		update addrbook
		set name=#{name}, companyName=#{companyName, jdbcType=VARCHAR}, deptName=#{deptName, jdbcType=VARCHAR}, posName=#{posName, jdbcType=VARCHAR},
			email=#{email},	hp=#{hp}, corpPhone=#{corpPhone, jdbcType=VARCHAR}, zipcode=#{zipcode, jdbcType=VARCHAR}, memo=#{memo, jdbcType=VARCHAR},
			address=#{address, jdbcType=VARCHAR},addressDetail=#{addressDetail, jdbcType=VARCHAR}
		where bookNo=#{bookNo}
	</update>
	
	<select id="selectByNo" parameterType="int" resultType="addrBookVo">
	 	select * from addrbook where bookNo=${bookNo}
	 </select>

</mapper>









